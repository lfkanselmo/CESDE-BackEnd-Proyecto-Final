create database Arkham_Properties;

use Arkham_Properties;

/*
PROPIETARIO
*/
CREATE TABLE PROPIETARIO(
ID_PROPIETARIO BIGINT PRIMARY KEY NOT NULL,
NOMBRE VARCHAR(35) NOT NULL,
APELLIDO VARCHAR(35) NOT NULL,
TELEFONO VARCHAR(11)  NOT NULL,
EMAIL NVARCHAR(50) DEFAULT 'NO REGISTRA' UNIQUE NOT NULL,
ACTIVO BIT DEFAULT 1 NOT NULL
);

/*
CLIENTE
*/
CREATE TABLE CLIENTE(
ID_CLIENTE BIGINT PRIMARY KEY NOT NULL,
NOMBRE VARCHAR(35) NOT NULL,
APELLIDO VARCHAR(35) NOT NULL,
TELEFONO VARCHAR(11)  NOT NULL,
EMAIL NVARCHAR(50) DEFAULT 'NO REGISTRA' UNIQUE NOT NULL,
ACTIVO BIT DEFAULT 1 NOT NULL
);

/*
INMUEBLE
*/
CREATE TABLE INMUEBLE(
ID_INMUEBLE BIGINT PRIMARY KEY  AUTO_INCREMENT NOT NULL,
PRECIO DECIMAL(18,1) NOT NULL,
DISPONIBILIDAD BIT DEFAULT 1 NOT NULL,
ID_PROPIETARIO BIGINT NOT NULL,
OFERTA VARCHAR(30) NOT NULL,
TIPO_INMUEBLE VARCHAR(30) NOT NULL,
NUMERO_HABITACIONES INT NOT NULL,
NUMERO_BANHOS INT NOT NULL,
AREA DECIMAL(18,1) NOT NULL,
PATIO BIT DEFAULT 0,
NIVEL INT DEFAULT 1 NOT NULL,
GAS_NATURAL BIT DEFAULT 0,
ZONA_DE_ROPAS BIT DEFAULT 0,
DIRECCION VARCHAR(100) 	UNIQUE NOT NULL,
BARRIO VARCHAR(30) NOT NULL,
CIUDAD VARCHAR(30) NOT NULL,
ACTIVO BIT DEFAULT 1 NOT NULL,

FOREIGN KEY (ID_PROPIETARIO) REFERENCES PROPIETARIO(ID_PROPIETARIO)
ON DELETE CASCADE
ON UPDATE CASCADE
);



/*
USUARIO
*/
CREATE TABLE USUARIO(
ID_USUARIO BIGINT PRIMARY KEY  AUTO_INCREMENT NOT NULL,
LOGIN VARCHAR(50) UNIQUE NOT NULL,
CONTRASENHA NVARCHAR(300) NOT NULL,
ROL VARCHAR(30) NOT NULL,
NOMBRE VARCHAR(35) NOT NULL,
APELLIDO VARCHAR(35) NOT NULL,
TELEFONO VARCHAR(11)  NOT NULL,
ACTIVO BIT DEFAULT 1 NOT NULL
);


/*
CITA
*/
CREATE TABLE CITA(
ID_CITA BIGINT PRIMARY KEY  AUTO_INCREMENT NOT NULL,
HORA_INICIO TIME NOT NULL,
HORA_FINAL TIME NOT NULL,
FECHA_CITA DATE NOT NULL,

ID_INMUEBLE BIGINT NOT NULL,
ID_CLIENTE BIGINT NOT NULL,
ID_USUARIO BIGINT NOT NULL,

FOREIGN KEY (ID_INMUEBLE) REFERENCES INMUEBLE(ID_INMUEBLE)
ON DELETE CASCADE
ON UPDATE CASCADE,
FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO(ID_USUARIO)
ON DELETE CASCADE
ON UPDATE CASCADE,
FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE)
ON DELETE CASCADE
ON UPDATE CASCADE
);

/*
TOKEN
*/

CREATE TABLE TOKEN(
ID_TOKEN BIGINT PRIMARY KEY AUTO_INCREMENT NOT NULL,
TOKEN NVARCHAR(300) NOT NULL,
TIPO_TOKEN VARCHAR(50) NOT NULL,
EXPIRADO BIT DEFAULT 1 NOT NULL,
REVOCADO BIT DEFAULT 1 NOT NULL,
ID_USUARIO BIGINT NOT NULL,
FOREIGN KEY (ID_USUARIO) REFERENCES USUARIO(ID_USUARIO)
ON DELETE CASCADE
ON UPDATE CASCADE
);

